Remote: ReplicatedStorage.GameEvents.LikeGarden
Remote: ReplicatedStorage.GameEvents.FriendPotLinkEnded_RE
Remote: ReplicatedStorage.GameEvents.SunResonance
Remote: ReplicatedStorage.GameEvents.SunStrike
Remote: ReplicatedStorage.GameEvents.PromptStarterPack
Remote: ReplicatedStorage.GameEvents.UpdateFriendState
Remote: ReplicatedStorage.GameEvents.CraftingGlobalObjectService
Remote: ReplicatedStorage.GameEvents.GetPetCooldown
Remote: ReplicatedStorage.GameEvents.CraftingFailedRemoteEvent
Remote: ReplicatedStorage.GameEvents.SprayService_RE
Remote: ReplicatedStorage.GameEvents.SetTutorialFinished
Remote: ReplicatedStorage.GameEvents.MeteorStrike
Remote: ReplicatedStorage.GameEvents.DiscoSetColor_RE
Remote: ReplicatedStorage.GameEvents.TanningMirrorService
Remote: ReplicatedStorage.GameEvents.PromptRSVP
Remote: ReplicatedStorage.GameEvents.SummerHarvestRewardRemoteEvent
Remote: ReplicatedStorage.GameEvents.SummerHarvestSubmitRemoteEvent
Remote: ReplicatedStorage.GameEvents.RefreshPetModel
Remote: ReplicatedStorage.GameEvents.InventorySortingServiceEvents.MoveEntry
Remote: ReplicatedStorage.GameEvents.BuyTravelingMerchantShopStock
Remote: ReplicatedStorage.GameEvents.MagnifyingGlassService_RE
Remote: ReplicatedStorage.GameEvents.FireworkVisual
Remote: ReplicatedStorage.GameEvents.FireworkLaunch
Remote: ReplicatedStorage.GameEvents.PhysicalFirework
Remote: ReplicatedStorage.ByteNetReliable
Remote: ReplicatedStorage.GameAnalyticsError
Remote: ReplicatedStorage.GameAnalyticsRemoteConfigs
Remote: ReplicatedStorage.PostieReceived
Remote: ReplicatedStorage.PostieSent
Remote: Workspace.aadawdada261h.InputGateway.Activation
Remote: Workspace.amaracakes2.InputGateway.Activation
Remote: Workspace.Leecapada.InputGateway.Activation
Remote: ReplicatedStorage.GameEvents.StarCallerService
Remote: ReplicatedStorage.GameEvents.CosmeticCrateSkipped
Remote: ReplicatedStorage.GameEvents.CosmeticCrateService
Remote: ReplicatedStorage.GameEvents.CrateReadyToOpen_RE
Remote: ReplicatedStorage.GameEvents.RemoteEvent
Remote: ReplicatedStorage.GameEvents.HarvestRemote
Remote: ReplicatedStorage.GameEvents.FriendInvitePrompterService
Remote: ReplicatedStorage.GameEvents.ExperienceNotificationServicePrompterController
Remote: ReplicatedStorage.GameEvents.CutsceneHandler
Remote: ReplicatedStorage.GameEvents.ReplicationChannel
Remote: ReplicatedStorage.GameEvents.LightningBoltWithNoFlash
Remote: ReplicatedStorage.GameEvents.JandelCharge
Remote: ReplicatedStorage.GameEvents.CosmeticPhysicalityService
Remote: ReplicatedStorage.GameEvents.RefreshActivePetsUI
Remote: ReplicatedStorage.GameEvents.CosmeticService
Remote: ReplicatedStorage.GameEvents.BuyCosmeticCrate
Remote: ReplicatedStorage.GameEvents.BuyCosmeticItem
Remote: ReplicatedStorage.GameEvents.BuyNightEventShopStock
Remote: ReplicatedStorage.GameEvents.BeeBolt
Remote: ReplicatedStorage.GameEvents.DeleteObject
Remote: ReplicatedStorage.GameEvents.SwarmFly
Remote: ReplicatedStorage.GameEvents.EggTutorial
Remote: ReplicatedStorage.GameEvents.CosmeticUpgradeService
Remote: ReplicatedStorage.GameEvents.CanSeeShopPack
Remote: ReplicatedStorage.GameEvents.PollenRadarHighlight
Remote: ReplicatedStorage.GameEvents.NectorStaffRemoteEvent
Remote: ReplicatedStorage.GameEvents.StartPollenRadarScan
Remote: ReplicatedStorage.GameEvents.FinishPollenRadarScan
Remote: ReplicatedStorage.GameEvents.FriendshipPotService_RE
Remote: ReplicatedStorage.GameEvents.FriendshipPotToolService_RE
Remote: ReplicatedStorage.GameEvents.PollenRadarCollectSound
Remote: ReplicatedStorage.GameEvents.HoneyCrafterRemoteEvent
Remote: ReplicatedStorage.GameEvents.PollenRadarReset
Remote: ReplicatedStorage.GameEvents.FriendPotLink_RE
Remote: ReplicatedStorage.GameEvents.LoadScreenEvent
Remote: ReplicatedStorage.GameEvents.SortBackpackEvent
Remote: ReplicatedStorage.GameEvents.ActivePetService
Remote: ReplicatedStorage.GameEvents.SpawnCollectableSeed
Remote: ReplicatedStorage.GameEvents.UnlockEventShopRemote
Remote: ReplicatedStorage.GameEvents.SeedPackGiverEvent
Remote: ReplicatedStorage.GameEvents.SprinklerService
Remote: ReplicatedStorage.GameEvents.PetsService
Remote: ReplicatedStorage.GameEvents.WeatherEventStarted
Remote: ReplicatedStorage.GameEvents.FireDrop
Remote: ReplicatedStorage.GameEvents.TurnOffEasterUI
Remote: ReplicatedStorage.GameEvents.BuyPetEgg
Remote: ReplicatedStorage.GameEvents.PetEggService
Remote: ReplicatedStorage.GameEvents.EggReadyToHatch_RE
Remote: ReplicatedStorage.GameEvents.ShecklesClient
Remote: ReplicatedStorage.GameEvents.SellPet_RE
Remote: ReplicatedStorage.GameEvents.PetGiftingService
Remote: ReplicatedStorage.GameEvents.PetZoneAbility
Remote: ReplicatedStorage.GameEvents.GiftPet
Remote: ReplicatedStorage.GameEvents.AcceptPetGift
Remote: ReplicatedStorage.GameEvents.PetSkipped
Remote: ReplicatedStorage.GameEvents.RecallWrenchTeleport
Remote: ReplicatedStorage.GameEvents.UnlockSlotFromPet
Remote: ReplicatedStorage.GameEvents.SpecialEventStarted
Remote: ReplicatedStorage.GameEvents.NightQuestRemoteEvent
Remote: ReplicatedStorage.GameEvents.FavoriteToolRemote
Remote: ReplicatedStorage.GameEvents.SettingsService
Remote: ReplicatedStorage.GameEvents.HighlightRemote
Remote: ReplicatedStorage.GameEvents.NightStaffRemoteEvent
Remote: ReplicatedStorage.GameEvents.ClaimableCodeService
Remote: ReplicatedStorage.GameEvents.SendClientSpecialEvent
Remote: ReplicatedStorage.GameEvents.ReclaimerService_RE
Remote: ReplicatedStorage.GameEvents.SummerHarvestRemoteEvent
Remote: ReplicatedStorage.GameEvents.MeteorShower
Remote: ReplicatedStorage.GameEvents.UpdateStock
Remote: ReplicatedStorage.GameEvents.BuyGearStock
Remote: ReplicatedStorage.GameEvents.DisplayChatMessage
Remote: ReplicatedStorage.GameEvents.UpdateGearStock
Remote: ReplicatedStorage.GameEvents.BuySeedStock
Remote: ReplicatedStorage.GameEvents.DevRestockGearShop
Remote: ReplicatedStorage.GameEvents.Enable_Top_Frame
Remote: ReplicatedStorage.GameEvents.Favorite_Item
Remote: ReplicatedStorage.GameEvents.Finish_Loading
Remote: ReplicatedStorage.GameEvents.Remove_Item
Remote: ReplicatedStorage.GameEvents.LightningBolt
Remote: ReplicatedStorage.GameEvents.Notification
Remote: ReplicatedStorage.GameEvents.PlaySound
Remote: ReplicatedStorage.GameEvents.Plant_RE
Remote: ReplicatedStorage.GameEvents.Pop_Effect
Remote: ReplicatedStorage.GameEvents.Prompt_Friend
Remote: ReplicatedStorage.GameEvents.BuyEasterStock
Remote: ReplicatedStorage.GameEvents.Sell_Inventory
Remote: ReplicatedStorage.GameEvents.Sell_Item
Remote: ReplicatedStorage.GameEvents.Purchase_Object
Remote: ReplicatedStorage.GameEvents.SendClientWeatherEvents
Remote: ReplicatedStorage.GameEvents.Send_Rating
Remote: ReplicatedStorage.GameEvents.Spawn_Arrow
Remote: ReplicatedStorage.GameEvents.Sprinkler_RE
Remote: ReplicatedStorage.GameEvents.Start_Cutscene
Remote: ReplicatedStorage.GameEvents.Water_RE
Remote: ReplicatedStorage.GameEvents.BuyEventShopStock
Remote: ReplicatedStorage.GameEvents.Close_Frames
Remote: ReplicatedStorage.GameEvents.PickupSound
Remote: ReplicatedStorage.GameEvents.TrowelRemote
Remote: ReplicatedStorage.GameEvents.LightningRodService
Remote: ReplicatedStorage.GameEvents.HoneyMachineService_RE
Remote: ReplicatedStorage.GameEvents.FriendGiftEvent
Remote: ReplicatedStorage.GameEvents.DeveloperPurchase
Remote: ReplicatedStorage.CmdrClient.CmdrEvent
Remote: ReplicatedStorage.CmdrClient.CmdrFunction
Remote: ReplicatedStorage.GameEvents.DataStreames

--[[
GAG SCRIPT BY:BREAD
Modern Sidebar GUI (Restarted)
--]]

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

-- Main GUI
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "GAG_SidebarGUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = playerGui

-- Sidebar Frame
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.Size = UDim2.new(0, 520, 0, 480) -- Increased width and height
sidebar.Position = UDim2.new(0.5, -260, 0.5, -240)
sidebar.BackgroundColor3 = Color3.fromRGB(120, 130, 150)
sidebar.BorderSizePixel = 0
sidebar.Parent = screenGui
sidebar.Visible = true

-- Top Bar
local topBar = Instance.new("Frame")
topBar.Name = "TopBar"
topBar.Size = UDim2.new(1, 0, 0, 44) -- Increased height
topBar.Position = UDim2.new(0, 0, 0, 0)
topBar.BackgroundColor3 = Color3.fromRGB(80, 90, 110)
topBar.BorderSizePixel = 0
topBar.Parent = sidebar

local topBarTitle = Instance.new("TextLabel")
topBarTitle.Name = "TopBarTitle"
topBarTitle.Size = UDim2.new(1, -80, 1, 0)
topBarTitle.Position = UDim2.new(0, 12, 0, 0)
topBarTitle.BackgroundTransparency = 1
topBarTitle.Text = "GAG SCRIPT BY:BREAD"
topBarTitle.Font = Enum.Font.SourceSansBold
topBarTitle.TextSize = 24
topBarTitle.TextColor3 = Color3.fromRGB(40, 40, 40)
topBarTitle.TextXAlignment = Enum.TextXAlignment.Left
topBarTitle.Parent = topBar

local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeBtn"
minimizeBtn.Size = UDim2.new(0, 32, 1, 0)
minimizeBtn.Position = UDim2.new(1, -64, 0, 0)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(80, 90, 110)
minimizeBtn.Text = "_"
minimizeBtn.Font = Enum.Font.SourceSansBold
minimizeBtn.TextSize = 22
minimizeBtn.TextColor3 = Color3.fromRGB(0,0,0)
minimizeBtn.Parent = topBar

local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseBtn"
closeBtn.Size = UDim2.new(0, 32, 1, 0)
closeBtn.Position = UDim2.new(1, -32, 0, 0)
closeBtn.BackgroundColor3 = Color3.fromRGB(120, 40, 40)
closeBtn.Text = "✕"
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 22
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Parent = topBar

-- Sidebar Tabs
local tabNames = {"EVENT", "SHOP", "FARM"}
local tabButtons = {}
for i, name in ipairs(tabNames) do
    local tabBtn = Instance.new("TextButton")
    tabBtn.Name = name .. "TabBtn"
    tabBtn.Size = UDim2.new(0, 120, 0, 54) -- Increased width and height
    tabBtn.Position = UDim2.new(0, 0, 0, 44 + (i-1)*54)
    tabBtn.BackgroundColor3 = i == 1 and Color3.fromRGB(220, 160, 80) or Color3.fromRGB(80, 90, 110)
    tabBtn.Text = name
    tabBtn.Font = Enum.Font.SourceSansBold
    tabBtn.TextSize = 24
    tabBtn.TextColor3 = Color3.fromRGB(40, 40, 40)
    tabBtn.BorderSizePixel = 0
    tabBtn.Parent = sidebar
    tabButtons[name] = tabBtn
end

-- Vertical Black Line
local navLine = Instance.new("Frame")
navLine.Size = UDim2.new(0, 4, 1, -44)
navLine.Position = UDim2.new(0, 120, 0, 44)
navLine.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
navLine.BorderSizePixel = 0
navLine.Parent = sidebar

-- Main Content Frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, -124, 1, -44)
contentFrame.Position = UDim2.new(0, 124, 0, 44)
contentFrame.BackgroundColor3 = Color3.fromRGB(120, 130, 150)
contentFrame.BorderSizePixel = 0
contentFrame.Parent = sidebar

-- Tab Content
local tabContent = {}
for _, name in ipairs(tabNames) do
    local frame = Instance.new("Frame")
    frame.Name = name .. "TabContent"
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundTransparency = 1
    frame.Visible = (name == "EVENT")
    frame.Parent = contentFrame
    tabContent[name] = frame
end

-- EVENT TAB CONTENT
local eventFrame = tabContent["EVENT"]
local eventHeader = Instance.new("TextLabel")
eventHeader.Size = UDim2.new(1, -32, 0, 40)
eventHeader.Position = UDim2.new(0, 16, 0, 16)
eventHeader.BackgroundColor3 = Color3.fromRGB(40, 90, 180)
eventHeader.Text = "SUMMER HARVEST"
eventHeader.Font = Enum.Font.SourceSansBold
eventHeader.TextSize = 22
eventHeader.TextColor3 = Color3.fromRGB(255,255,255)
eventHeader.BorderSizePixel = 0
eventHeader.TextXAlignment = Enum.TextXAlignment.Center
eventHeader.Parent = eventFrame

local autoSubmitToggle = Instance.new("TextButton")
autoSubmitToggle.Name = "AutoSubmitToggle"
autoSubmitToggle.Size = UDim2.new(1, -32, 0, 36)
autoSubmitToggle.Position = UDim2.new(0, 16, 0, 64)
autoSubmitToggle.BackgroundColor3 = Color3.fromRGB(60, 90, 130)
autoSubmitToggle.Text = "AUTO SUBMIT:"
autoSubmitToggle.Font = Enum.Font.SourceSansBold
autoSubmitToggle.TextSize = 20
autoSubmitToggle.TextColor3 = Color3.fromRGB(255,255,255)
autoSubmitToggle.BorderSizePixel = 0
autoSubmitToggle.TextXAlignment = Enum.TextXAlignment.Left
autoSubmitToggle.Parent = eventFrame

local check = Instance.new("TextLabel")
check.Name = "Checkmark"
check.Size = UDim2.new(0, 32, 1, 0)
check.Position = UDim2.new(1, -36, 0, 0)
check.BackgroundTransparency = 1
check.Font = Enum.Font.SourceSansBold
check.TextSize = 24
check.TextColor3 = Color3.fromRGB(220, 220, 220)
check.Text = ""
check.Parent = autoSubmitToggle

local autoSubmitState = false
local function updateAutoSubmitToggle()
    autoSubmitToggle.BackgroundColor3 = autoSubmitState and Color3.fromRGB(40, 90, 180) or Color3.fromRGB(60, 90, 130)
    check.Text = autoSubmitState and "✔" or ""
end
updateAutoSubmitToggle()
autoSubmitToggle.MouseButton1Click:Connect(function()
    autoSubmitState = not autoSubmitState
    updateAutoSubmitToggle()
end)

-- === SHOP TAB CONTENT CLEANUP ===
local shopFrame = tabContent["SHOP"]

-- Dropdown Data
local eggOptions = {
    "Common Egg", "Uncommon Egg", "Rare Egg", "Legendary Egg", "Mythical Egg", "Bug Egg", "Exotic Bug Egg", "Night Egg", "Premium Night Egg", "Bee Egg", "Anti Bee Egg", "Premium Anti Bee Egg", "Common Summer Egg", "Rare Summer Egg", "Paradise Egg", "Oasis Egg", "Premium Oasis Egg"
}
local eggDetails = {
    ["Common Egg"] = "50,000 | Golden Lab, Dog, Bunny (33.33% each)",
    ["Uncommon Egg"] = "150,000 | Black Bunny, Chicken, Cat, Deer (25% each)",
    ["Rare Egg"] = "600,000 | Orange Tabby, Spotted Deer, Pig, Rooster, Monkey",
    ["Legendary Egg"] = "3,000,000 | Cow, Silver Monkey, Sea Otter, Turtle, Polar Bear",
    ["Mythical Egg"] = "8,000,000 | Grey Mouse, Brown Mouse, Squirrel, Red Giant Ant, Red Fox",
    ["Bug Egg"] = "50,000,000 | Snail, Giant Ant, Caterpillar, Praying Mantis, Dragonfly",
    ["Exotic Bug Egg"] = "Limited Time Shop",
    ["Night Egg"] = "25M/50M | Hedgehog, Mole, Frog, Echo Frog, Night Owl, Raccoon",
    ["Premium Night Egg"] = "199 | Hedgehog, Mole, Frog, Echo Frog, Night Owl, Raccoon",
    ["Bee Egg"] = "18 | Bee, Honey Bee, Bear Bee, Petal Bee, Queen Bee",
    ["Anti Bee Egg"] = "Crafting | Wasp, Tarantula Hawk, Moth, Butterfly, Disco Bee",
    ["Premium Anti Bee Egg"] = "199 | Limited Time Shop",
    ["Common Summer Egg"] = "1,000,000 | Starfish, Seagull, Crab",
    ["Rare Summer Egg"] = "25,000,000 | Flamingo, Toucan, Sea Turtle, Orangutan, Seal",
    ["Paradise Egg"] = "50,000,000 | Ostrich, Peacock, Capybara, Scarlet Macaw, Mimic Octopus",
    ["Oasis Egg"] = "10 | Meerkat, Sand Snake, Axolotl, Hyacinth Macaw, Fennec Fox",
    ["Premium Oasis Egg"] = "199 | Limited Time Shop"
}
local seedOptions = {
    "Carrot", "Strawberry", "Blueberry", "Tomato", "Cauliflower", "Watermelon", "Rafflesia", "Green Apple", "Avocado", "Banana", "Pineapple", "Kiwi", "Bell Pepper", "Prickly Pear", "Loquat", "Feijoa", "Pitcher Plant", "Sugar Apple"
}
local seedDetails = {
    ["Carrot"] = "10 | Common | 5-25 | ✗/✓",
    ["Strawberry"] = "50 | Common | 1-6 | ✓/✓",
    ["Blueberry"] = "400 | Uncommon | 1-5 | ✓/✓",
    ["Tomato"] = "800 | Rare | 1-3 | ✓/✓",
    ["Cauliflower"] = "1,300 | Rare | 1-4 | ✓/✓",
    ["Watermelon"] = "2,500 | Rare | 1-7 | ✗/✓",
    ["Rafflesia"] = "3,200 | Legendary | 1-? | ✗/✓",
    ["Green Apple"] = "3,500 | Legendary | 1 | ✓/✓",
    ["Avocado"] = "5,000 | Legendary | 1 | ✓/✓",
    ["Banana"] = "7,000 | Legendary | 1 | ✓/✓",
    ["Pineapple"] = "7,500 | Mythical | 1 | ✓/✓",
    ["Kiwi"] = "10,000 | Mythical | 1 | ✓/✓",
    ["Bell Pepper"] = "55,000 | Mythical | 1 | ✓/✓",
    ["Prickly Pear"] = "555,000 | Mythical | 1 | ✓/✓",
    ["Loquat"] = "900,000 | Divine | 1 | ✓/✓",
    ["Feijoa"] = "2,750,000 | Divine | 1 | ✓/✓",
    ["Pitcher Plant"] = "7,500,000 | Divine | 1 | ✓/✓",
    ["Sugar Apple"] = "25,000,000 | Prismatic | 1"
}

-- Helper: Create Dropdown
local function createDropdown(parent, name, options, details, yPos, prefix)
    local btn = Instance.new("TextButton")
    btn.Name = name .. "DropdownBtn"
    btn.Size = UDim2.new(1, -40, 0, 44)
    btn.Position = UDim2.new(0, 20, 0, yPos)
    btn.BackgroundColor3 = Color3.fromRGB(40, 90, 180)
    btn.Text = prefix
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 22
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.BorderSizePixel = 0
    btn.TextXAlignment = Enum.TextXAlignment.Center
    btn.Parent = parent
    btn.ZIndex = 2

    local list = Instance.new("ScrollingFrame")
    list.Name = name .. "DropdownList"
    list.Size = UDim2.new(1, -40, 0, 0)
    list.Position = UDim2.new(0, 20, 0, yPos + 44)
    list.BackgroundColor3 = Color3.fromRGB(60, 120, 180)
    list.BorderSizePixel = 0
    list.Visible = false
    list.Parent = parent
    list.ZIndex = 3
    list.ClipsDescendants = true
    list.CanvasSize = UDim2.new(0, 0, 0, 0)
    list.ScrollBarThickness = 10

    local selected = {}
    for i, option in ipairs(options) do
        local opt = Instance.new("TextButton")
        opt.Size = UDim2.new(1, 0, 0, 38)
        opt.Position = UDim2.new(0, 0, 0, (i-1)*38)
        opt.BackgroundColor3 = Color3.fromRGB(100, 170, 220)
        opt.Text = option
        opt.Font = Enum.Font.SourceSans
        opt.TextSize = 20
        opt.TextColor3 = Color3.fromRGB(255,255,255)
        opt.BorderSizePixel = 0
        opt.Parent = list
        opt.ZIndex = 4
        opt.MouseEnter:Connect(function()
            opt.Text = option .. "\n" .. (details[option] or "")
            opt.TextWrapped = true
        end)
        opt.MouseLeave:Connect(function()
            opt.Text = option
            opt.TextWrapped = false
        end)
        opt.MouseButton1Click:Connect(function()
            local found = false
            for j, v in ipairs(selected) do
                if v == option then table.remove(selected, j) found = true break end
            end
            if not found then table.insert(selected, option) end
            btn.Text = (#selected == 0) and prefix or (prefix .. " " .. table.concat(selected, ", "))
            opt.BackgroundColor3 = found and Color3.fromRGB(100, 170, 220) or Color3.fromRGB(60, 200, 120)
        end)
    end
    btn.Text = (#selected == 0) and prefix or (prefix .. " " .. table.concat(selected, ", "))
    list.CanvasSize = UDim2.new(0, 0, 0, #options * 38)
    btn.MouseButton1Click:Connect(function()
        list.Visible = not list.Visible
        updateShopTogglePositions()
    end)
    return btn, list, selected
end

-- Create Dropdowns
local eggDropdownBtn, eggDropdownList, selectedEggs = createDropdown(shopFrame, "Egg", eggOptions, eggDetails, 20, "BUY EGG:")
local seedDropdownBtn, seedDropdownList, selectedSeeds = createDropdown(shopFrame, "Seed", seedOptions, seedDetails, 74 + (#eggOptions * 38), "BUY SEEDS:")

-- Helper: Create Toggle
local function createAutoBuyToggle(parent, name, yPos)
    local toggle = Instance.new("TextButton")
    toggle.Name = name .. "Toggle"
    toggle.Size = UDim2.new(1, -32, 0, 36)
    toggle.Position = UDim2.new(0, 20, 0, yPos)
    toggle.BackgroundColor3 = Color3.fromRGB(60, 90, 130)
    toggle.Text = "AUTO BUY " .. name:upper()
    toggle.Font = Enum.Font.SourceSansBold
    toggle.TextSize = 20
    toggle.TextColor3 = Color3.fromRGB(255,255,255)
    toggle.BorderSizePixel = 0
    toggle.TextXAlignment = Enum.TextXAlignment.Left
    toggle.Parent = parent
    toggle.ZIndex = 2

    local check = Instance.new("TextLabel")
    check.Name = "Checkmark"
    check.Size = UDim2.new(0, 32, 1, 0)
    check.Position = UDim2.new(1, -36, 0, 0)
    check.BackgroundTransparency = 1
    check.Font = Enum.Font.SourceSansBold
    check.TextSize = 24
    check.TextColor3 = Color3.fromRGB(220, 220, 220)
    check.Text = ""
    check.Parent = toggle
    return toggle, check
end

local autoBuyEggToggle, eggCheck = createAutoBuyToggle(shopFrame, "Egg", 0)
local autoBuySeedToggle, seedCheck = createAutoBuyToggle(shopFrame, "Seed", 54)

local autoBuyEggState, autoBuySeedState = false, false

local function updateAutoBuyToggle(toggle, check, state)
    if state then
        toggle.BackgroundColor3 = Color3.fromRGB(40, 90, 180)
        check.Text = "✅"
    else
        toggle.BackgroundColor3 = Color3.fromRGB(60, 90, 130)
        check.Text = ""
    end
end
updateAutoBuyToggle(autoBuyEggToggle, eggCheck, autoBuyEggState)
updateAutoBuyToggle(autoBuySeedToggle, seedCheck, autoBuySeedState)

-- Automation Remotes
local buyEggRemote = ReplicatedStorage:FindFirstChild("GameEvents") and ReplicatedStorage.GameEvents:FindFirstChild("BuyPetEgg")
local buySeedRemote = ReplicatedStorage:FindFirstChild("GameEvents") and ReplicatedStorage.GameEvents:FindFirstChild("BuySeedStock")

-- Helper: Check if in stock (stub, should be replaced with real stock check if available)
local function isEggInStock(eggName) return true end
local function isSeedInStock(seedName) return true end

-- Auto-buy logic
local function startAutoBuyLoop(stateVar, selectedList, remote, isInStock)
    task.spawn(function()
        while true do
            if stateVar[1] then
                for _, item in ipairs(selectedList) do
                    if isInStock(item) then
                        if remote then
                            remote:FireServer(item)
                        end
                    end
                end
            end
            task.wait(0.1)
        end
    end)
end

-- Toggle connections
autoBuyEggToggle.MouseButton1Click:Connect(function()
    autoBuyEggState = not autoBuyEggState
    updateAutoBuyToggle(autoBuyEggToggle, eggCheck, autoBuyEggState)
end)
autoBuySeedToggle.MouseButton1Click:Connect(function()
    autoBuySeedState = not autoBuySeedState
    updateAutoBuyToggle(autoBuySeedToggle, seedCheck, autoBuySeedState)
end)

-- Start auto-buy loops on script load
startAutoBuyLoop({function() return autoBuyEggState end}, selectedEggs, buyEggRemote, isEggInStock)
startAutoBuyLoop({function() return autoBuySeedState end}, selectedSeeds, buySeedRemote, isSeedInStock)

-- Update toggle positions based on dropdowns
function updateShopTogglePositions()
    local y = 20
    local contentBottom = shopFrame.AbsolutePosition.Y + shopFrame.AbsoluteSize.Y
    -- Egg Dropdown
    eggDropdownBtn.Position = UDim2.new(0, 20, 0, y)
    y = y + 44
    if eggDropdownList.Visible then
        local dropdownTop = shopFrame.AbsolutePosition.Y + y
        local maxHeight = contentBottom - dropdownTop - 20
        local needed = #eggOptions * 38
        local showHeight = math.max(0, math.min(needed, maxHeight))
        eggDropdownList.Position = UDim2.new(0, 20, 0, y)
        eggDropdownList.Size = UDim2.new(1, -40, 0, showHeight)
        eggDropdownList.CanvasSize = UDim2.new(0, 0, 0, needed)
        y = y + showHeight
    else
        eggDropdownList.Position = UDim2.new(0, 20, 0, y)
        eggDropdownList.Size = UDim2.new(1, -40, 0, 0)
    end
    -- Seed Dropdown
    seedDropdownBtn.Position = UDim2.new(0, 20, 0, y)
    y = y + 44
    if seedDropdownList.Visible then
        local dropdownTop = shopFrame.AbsolutePosition.Y + y
        local maxHeight = contentBottom - dropdownTop - 20
        local needed = #seedOptions * 38
        local showHeight = math.max(0, math.min(needed, maxHeight))
        seedDropdownList.Position = UDim2.new(0, 20, 0, y)
        seedDropdownList.Size = UDim2.new(1, -40, 0, showHeight)
        seedDropdownList.CanvasSize = UDim2.new(0, 0, 0, needed)
        y = y + showHeight
    else
        seedDropdownList.Position = UDim2.new(0, 20, 0, y)
        seedDropdownList.Size = UDim2.new(1, -40, 0, 0)
    end
    -- Toggles
    autoBuyEggToggle.Position = UDim2.new(0, 20, 0, y + 18)
    autoBuySeedToggle.Position = UDim2.new(0, 20, 0, y + 18 + 54)
end

eggDropdownBtn.MouseButton1Click:Connect(function()
    eggDropdownList.Visible = not eggDropdownList.Visible
    updateShopTogglePositions()
end)
seedDropdownBtn.MouseButton1Click:Connect(function()
    seedDropdownList.Visible = not seedDropdownList.Visible
    updateShopTogglePositions()
end)

UserInputService.InputBegan:Connect(function(input, processed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        local changed = false
        if eggDropdownList.Visible and not eggDropdownBtn:IsAncestorOf(input.Target) then
            eggDropdownList.Visible = false
            changed = true
        end
        if seedDropdownList.Visible and not seedDropdownBtn:IsAncestorOf(input.Target) then
            seedDropdownList.Visible = false
            changed = true
        end
        if changed then updateShopTogglePositions() end
    end
end)

-- Hide dropdowns if clicking elsewhere
UserInputService.InputBegan:Connect(function(input, processed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        local changed = false
        if eggDropdownList.Visible and not eggDropdownBtn:IsAncestorOf(input.Target) then
            eggDropdownList.Visible = false
            changed = true
        end
        if seedDropdownList.Visible and not seedDropdownBtn:IsAncestorOf(input.Target) then
            seedDropdownList.Visible = false
            changed = true
        end
        if changed then updateShopTogglePositions() end
    end
end)

-- Automation Remotes
local buyEggRemote = ReplicatedStorage:FindFirstChild("GameEvents"):FindFirstChild("BuyPetEgg")
local buySeedRemote = ReplicatedStorage:FindFirstChild("GameEvents"):FindFirstChild("BuySeedStock")

-- Helper: Check if an egg/seed is in stock (stub, should be replaced with real stock check if available)
local function isEggInStock(eggName)
    -- TODO: Replace with real stock check if possible
    return true -- Assume always in stock for now
end
local function isSeedInStock(seedName)
    -- TODO: Replace with real stock check if possible
    return true -- Assume always in stock for now
end

-- Auto-buy logic
local autoBuyEggLoopRunning = false
local autoBuySeedLoopRunning = false

-- Start auto-buy egg loop on script load
if not autoBuyEggLoopRunning then
    autoBuyEggLoopRunning = true
    task.spawn(function()
        while true do
            if autoBuyEggState then
                for _, egg in ipairs(selectedEggs) do
                    if isEggInStock(egg) then
                        if buyEggRemote then
                            buyEggRemote:FireServer(egg)
                        end
                    end
                end
            end
            task.wait(0.1)
        end
    end)
end

-- Start auto-buy seed loop on script load
if not autoBuySeedLoopRunning then
    autoBuySeedLoopRunning = true
    task.spawn(function()
        while true do
            if autoBuySeedState then
                for _, seed in ipairs(selectedSeeds) do
                    if isSeedInStock(seed) then
                        if buySeedRemote then
                            buySeedRemote:FireServer(seed)
                        end
                    end
                end
            end
            task.wait(0.1)
        end
    end)
end

-- Tab Switching Logic
local function selectTab(tabName)
    for name, btn in pairs(tabButtons) do
        btn.BackgroundColor3 = name == tabName and Color3.fromRGB(220, 160, 80) or Color3.fromRGB(80, 90, 110)
    end
    for name, frame in pairs(tabContent) do
        frame.Visible = (name == tabName)
    end
end
for name, btn in pairs(tabButtons) do
    btn.MouseButton1Click:Connect(function()
        selectTab(name)
    end)
end

-- Hide/Show Logic
local showUIButton = Instance.new("TextButton")
showUIButton.Name = "ShowUIButton"
showUIButton.Size = UDim2.new(0, 140, 0, 36)
showUIButton.Position = UDim2.new(0, 20, 0, 20)
showUIButton.BackgroundColor3 = Color3.fromRGB(80, 90, 110)
showUIButton.Text = "Show GAG UI"
showUIButton.Font = Enum.Font.SourceSansBold
showUIButton.TextSize = 20
showUIButton.TextColor3 = Color3.fromRGB(255,255,255)
showUIButton.Visible = false
showUIButton.Parent = screenGui

local function hideUI()
    sidebar.Visible = false
    showUIButton.Visible = true
end
local function showUI()
    sidebar.Visible = true
    showUIButton.Visible = false
end
closeBtn.MouseButton1Click:Connect(hideUI)
showUIButton.MouseButton1Click:Connect(showUI)
minimizeBtn.MouseButton1Click:Connect(function()
    sidebar.Visible = not sidebar.Visible
    showUIButton.Visible = not sidebar.Visible
end)
UserInputService.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.RightShift then
        if sidebar.Visible then
            hideUI()
        else
            showUI()
        end
    end
end)

-- Initial tab selection
selectTab("EVENT")
